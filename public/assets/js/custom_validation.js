function isNumber(e){return!!e.match(/^[0-9]+$/)}function isChar(e){return!!e.match(/^[a-zA-Z]+$/)}function isEmpty(e){return""==e||null==e}function isEmail(e){return!!/^\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/.test(e)}function error(e,r,t){$("#"+e).css({border:"1px solid red"}),$("#"+r).html(t)}function success(e,r,t){$("#"+e).css({border:"1px solid green"}),$("#"+r).html(t)}function isUrl(e){return!!/^(?:(ftp|http|https)?:\/\/)?(?:[\w-]+\.)+([a-z]|[A-Z]|[0-9]){2,6}$/.test(e)}function isSpecialPassword(e){return!!/^(?=.*[A-Z])(?=.*[a-z])(?=.*[0-9])(?=.*[!@#$%^&*])[a-zA-Z0-9!@#$%^&*]{6,16}$/.test(e)}function length(e,r,t){var o=e.length;return o>=r&&o<=t}function show_loading(){$(".loading").show()}function login(e,r){localStorage.setItem("token",r.result.token),localStorage.setItem("local_id",r.result.local_id),window.location.href="/"}function register1(e,r){window.location.href="/api/auth/completeRegister?mobile="+r.email+"&code=1"}function otpverify(e,r){window.location.href="/"}function createpassword(e,r){window.location.href="/success"}function forgetpassword(e,r){window.location.href="/api/auth/completeForgetpassword?mobile="+r.email}function reset_password(e,r){window.location.href="/api/auth/login?msg=successfully reset password, please login to continue your service"}function Global_ajaxCall(e,r,t,o,a){$.ajax({type:r,url:e,dataType:"json",data:o,success:function(e){"login"==a?login(t,e):"register"==a?register1(t,e):"otpverify"==a?otpverify(t,e):"createpassword"==a?createpassword(t,e):"forgetpassword"==a?forgetpassword(t,e):"reset_password"==a&&reset_password(t,e)},error:function(e,r,a){return 500==e.status?($(".loading").hide(),a=(a=$.parseJSON(e.responseText)).message,$("#"+t).show().html(a),"please activate your account before login"==a&&(window.location.href="/api/auth/completeRegister?mobile="+o.mobile),"otp already send to your mobile"==a&&(window.location.href="/api/auth/completeForgetpassword?mobile="+o.mobile),!1):(alert("System error found refresh page"),!1)}})}$(document).ready(function(){$(document).on("click",".show_password",function(){"password"==$("#"+$(this).attr("data-btn")).attr("type")?($("#"+$(this).attr("data-btn")).attr("type","text"),$(this).html("hide")):($("#"+$(this).attr("data-btn")).attr("type","password"),$(this).html("show"))}),$(document).on("submit","#reset_password_form",function(e){var r=$("#OTP_txt").val(),t=$("#mobile_txt").attr("data-value"),o=$("#createpassword_pwd1").val(),a=$("#createpassword_pwd2").val();if(isEmpty(r)||isEmpty(o)||isEmpty(a))return e.preventDefault(),$("#error").show().html("OTP required"),!1;if(!length(r,6,6))return e.preventDefault(),$("#error").show().html("Invalid OTP found"),!1;if(!isNumber(r))return e.preventDefault(),$("#error").show().html("Invalid OTP found"),!1;if(o.length<=6)return e.preventDefault(),$("#error").show().html("Invalid mobile number or password found"),!1;if(o!=a)return e.preventDefault(),$("#error").show().html("Password not match"),!1;$("#error").hide();return Global_ajaxCall("/api/auth/completeForgetpassword","POST","error",{mobile:t,code:r,password:o},"reset_password"),show_loading(),e.preventDefault(),!0}),$(document).on("submit","#login_form",function(e){var r=$("#mobile_txt").val(),t=$("#pwd1").val();if(isEmpty(r))return e.preventDefault(),$("#error").show().html("Mobile number required"),!1;if(isEmpty(t))return e.preventDefault(),$("#error").show().html("password required"),!1;if(!isNumber(r)||!length(r,10,10))return e.preventDefault(),$("#error").show().html("Invalid mobile number found"),!1;if(t.length<=6)return e.preventDefault(),$("#error").show().html("Invalid mobile number or password found"),!1;$("#error").hide(),show_loading();return Global_ajaxCall("/api/auth/login","POST","error",{mobile:r,password:t},"login"),e.preventDefault(),!0}),$(document).on("submit","#register_form",function(e){var r=$("#mobile_txt").val(),t=$("#createpassword_pwd1").val(),o=$("#createpassword_pwd2").val();if(isEmpty(r))return e.preventDefault(),$("#error").show().html("mobile number required"),!1;if(!length(r,10,10))return e.preventDefault(),$("#error").show().html("Invalid Mobile number found"),!1;if(!isNumber(r))return e.preventDefault(),$("#error").show().html("Invalid Mobile number found"),!1;if(t.length<=6)return e.preventDefault(),$("#error").show().html("password at least 6 characters"),!1;if(t!=o)return e.preventDefault(),$("#error").show().html("password not match"),!1;$("#error").hide();return Global_ajaxCall("/api/auth/register","POST","error",{mobile:r,password:t},"register"),show_loading(),e.preventDefault(),!0}),$(document).on("submit","#otpverify_form",function(e){var r=$("#OTP_txt").val();if(isEmpty(r))return e.preventDefault(),$("#error").show().html("OTP required"),!1;if(!length(r,6,6))return e.preventDefault(),$("#error").show().html("Invalid OTP found"),!1;if(!isNumber(r))return e.preventDefault(),$("#error").show().html("Invalid OTP found"),!1;$("#error").hide(),$("#mobile_txt").html();return Global_ajaxCall("/api/auth/completeRegister","POST","error",{mobile:$("#mobile_txt").html(),code:r},"otpverify"),show_loading(),e.preventDefault(),!0}),$(document).on("submit","#forgetpassword_form",function(e){var r=$("#mobile_txt").val();if(!isEmpty(r)){if(isNumber(r)){if(length(r,10,10)){$("#error").hide(),show_loading();return Global_ajaxCall("/api/auth/forgetpassword","POST","error",{mobile:r},"forgetpassword"),e.preventDefault(),!0}return e.preventDefault(),$("#error").show().html("Invalid mobile number found"),!1}return e.preventDefault(),$("#error").show().html("Only numeric value required"),!1}return e.preventDefault(),$("#error").show().html("Mobile number required"),!1}),$(document).on("submit","#createpassword_form",function(e){var r=$("#createpassword_pwd1").val(),t=$("#createpassword_pwd2").val();if(isEmpty(r)||isEmpty(t))return e.preventDefault(),$("#error").show().html("Password required"),!1;if(!length(r,8,32))return e.preventDefault(),$("#error").show().html("Password must be more than 8 characters"),!1;if(r!=t)return e.preventDefault(),$("#error").show().html("Password not match"),!1;$("#error").hide();var o={email:$("#mobile_txt").attr("data-value"),password:r};return $.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),Global_ajaxCall("/api/auth/create_password","POST","error",o,"createpassword"),show_loading(),e.preventDefault(),!0})});